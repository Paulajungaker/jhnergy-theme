{{ 'section-product-pdp.css' | asset_url | stylesheet_tag }}
{{ 'section-product-pdp.js'  | asset_url | script_tag }}

<section class="section section--product">
  <div class="page-width product-pdp">
  
    <nav class="product-breadcrumb">
      <a href="/" class="breadcrumb__link">Home</a>
      <span class="breadcrumb__separator">/</span>
      <a href="/collections" class="breadcrumb__link">Shop</a>
      <span class="breadcrumb__separator">/</span>
      <span class="breadcrumb__current">
        {{ product.title }}
      </span>
    </nav>

    <div class="pdp-main">
      <!-- GALLERI -->
      <div class="pdp-gallery">
        <div class="pdp-gallery__main">
          {% if product.featured_image %}
            {{ product.featured_image
              | image_url: width: 1200
              | image_tag: loading: 'lazy', class: 'pdp-gallery__main-image'
            }}
          {% endif %}
        </div>

        {% if product.images.size > 1 %}
          <div class="pdp-gallery__thumbs">
            {% for image in product.images %}
              <button
                type="button"
                class="pdp-thumb{% if forloop.first %} is-active{% endif %}"
                data-pdp-thumb-id="{{ image.id }}"
              >
                {{ image
                  | image_url: width: 300
                  | image_tag: loading: 'lazy', class: 'pdp-thumb__image'
                }}
              </button>
            {% endfor %}
          </div>
        {% endif %}
      </div>

     <!-- BUY BOX -->
      <form
        id="PdpForm"
        action="/cart/add"
        method="post"
        class="pdp-buy"
      >
        {%- comment -%} Hidden variant-id (uppdateras i JS) {%- endcomment -%}
        <input
          type="hidden"
          name="id"
          id="PdpVariantId"
          value="{{ product.selected_or_first_available_variant.id }}"
        >

        <h1 class="pdp-buy__title">
          {{ product.title }}
        </h1>

        <p class="pdp-buy__price">
          {{ product.price | money }}
        </p>

        <p class="pdp-buy__excerpt">
          {{ product.description | strip_html | truncatewords: 24 }}
        </p>

{% for option in product.options_with_values %}
  {% if option.name == 'Color' %}
    {% assign default_color = option.values[0] %}

   <div class="pdp-buy__section pdp-color-section">
  <p class="pdp-buy__label">Select color</p>

  <div class="pdp-color-wrapper">
    <div class="pdp-buy__colors">
      {% for value in option.values %}
        {% assign color_handle = value | handle %}

        <button
          type="button"
          class="pdp-color-swatch pdp-color--{{ color_handle }}{% if forloop.first %} is-active{% endif %}"
          aria-label="{{ value }}"
          data-option="Color"
          data-value="{{ value | escape }}"
        ></button>
      {% endfor %}
    </div>

    <p class="pdp-color-label"
      data-default-label="{{ default_color | escape }}"
    >
      {{ default_color }}
    </p>
  </div>
</div>
  {% endif %}
{% endfor %}

{% for option in product.options_with_values %}
  {% if option.name == 'Size' or option.name == 'Talla' %}
    <div class="pdp-buy__section">
      <p class="pdp-buy__label">Select size</p>

      <div class="pdp-buy__sizes">
        {% for value in option.values %}
          <button type="button"
                  class="pdp-size-pill{% if forloop.first %} is-active{% endif %}"
                  data-option="{{ option.name }}"
                  data-value="{{ value | escape }}">
            {{ value }}
          </button>
        {% endfor %}
      </div>
    </div>
  {% endif %}
{% endfor %}

       {%- comment -%} QUANTITY STEPPER {%- endcomment -%}
        <div class="pdp-buy__section pdp-qty">
          <div class="pdp-qty__controls">
            <button type="button" class="pdp-qty__btn" aria-label="Decrease quantity">
              –
            </button>
            <div class="pdp-qty__value" aria-live="polite">
              1
            </div>
            <button type="button" class="pdp-qty__btn" aria-label="Increase quantity">
              +
            </button>
          </div>
        </div>

        {%- comment -%} Hidden quantity som JS syncar med steppern {%- endcomment -%}
        <input
          type="hidden"
          name="quantity"
          id="PdpQtyInput"
          value="1"
        >

<button
  id="PdpBuyButton"
  class="pdp-buy-button{% unless product.available %} is-disabled{% endunless %}"
  {% unless product.available %}disabled{% endunless %}
>
  Buy Now
</button>

        <div class="pdp-info">
          <div class="pdp-info__icons">
            <span class="pdp-info__icon">
              <img src="{{ 'icon-shipping.svg' | asset_url }}" alt="Fast shipping">
            </span>
            <span class="pdp-info__icon">
              <img src="{{ 'icon-return.svg' | asset_url }}" alt="Secure checkout">
            </span>
            <span class="pdp-info__icon">
              <img src="{{ 'icon-secure.svg' | asset_url }}" alt="Free returns">
            </span>
          </div>

          <p class="pdp-info__text">
            Fast shipping (1–3 days) / Free 30-day returns
          </p>
        </div>
      </form> 
    </div>    

<!-- PRODUCT DETAILS -->
<div class="pdp-details">
  <h2 class="pdp-details__heading">
    Product details
  </h2>

  <div class="pdp-details__list">
    {%- assign product_info = product.metafields.custom.product_information -%}

    <div class="pdp-accordion__item is-open">
      <button class="pdp-accordion__header" type="button">
        <span class="pdp-accordion__title">Product information</span>
        <span class="pdp-accordion__icon">
          <img src="{{ 'icon-chevron-down.svg' | asset_url }}" alt="">
        </span>
      </button>

      <div class="pdp-accordion__panel">
        {%- if product_info != blank -%}
          {{ product_info | newline_to_br }}
        {%- else -%}
          {{ product.description }}
        {%- endif -%}
      </div>
    </div>
  </div>
</div>

    {%- comment -%} YOU MAY ALSO LIKE {%- endcomment -%}
{%- assign reco_collection = collections['frontpage'] -%}

{% if reco_collection %}
  <div class="pdp-recommendations">
    <h2 class="pdp-recommendations__heading">You may also like</h2>

    <div class="pdp-recommendations__list">
      {% for reco_product in reco_collection.products limit: 8 %}
        <a href="{{ reco_product.url }}" class="pdp-reco-card">
          {% if reco_product.featured_image %}
            {{ reco_product.featured_image
              | image_url: width: 400
              | image_tag: class: 'pdp-reco-card__image'
            }}
          {% endif %}

          <p class="pdp-reco-card__title">
            {{ reco_product.title }}
          </p>
          <p class="pdp-reco-card__price">
            {{ reco_product.price | money }}
          </p>
        </a>
      {% endfor %}
    </div>
  </div>
{% endif %}

{%- comment -%} Variant-data för JS {%- endcomment -%}
<script id="PdpVariantsJSON" type="application/json">
[
  {% for variant in product.variants %}
    {
      "id": {{ variant.id }},
      "available": {{ variant.available | json }},
      "price": {{ variant.price | json }},
      "price_formatted": {{ variant.price | money | json }},
      "option1": {{ variant.option1 | json }},
      "option2": {{ variant.option2 | json }},
      "option3": {{ variant.option3 | json }}
    }{% unless forloop.last %},{% endunless %}
  {% endfor %}
]
</script>

<script id="PdpOptionsJSON" type="application/json">
  {{ product.options | json }}
</script>

  </div>
</section>

{% schema %}
{
  "name": "Product – PDP layout",
  "settings": [],
  "presets": [
    {
      "name": "Product – PDP layout"
    }
  ]
}
{% endschema %}